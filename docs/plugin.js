(function(){"use strict";const{ActionTypes:e}=cumcord.modules.common.constants,{getChannelId:n}=cumcord.modules.webpackModules.findByProps("getChannelId","getLastSelectedChannelId","getVoiceChannelId"),{FluxDispatcher:s}=cumcord.modules.common,{getChannel:t}=cumcord.modules.webpackModules.findByProps("getChannel"),{getMessages:i}=cumcord.modules.webpackModules.findByProps("getMessages");let l=new class{constructor(){this.messageIndex=-1,this.activeChannel=n(),this.replyingToMessage=void 0,this.QRSymbol=Symbol("quickreply_deletePendingReply_int")}getCurrentChannel(){return t(n())}async createPendingReply(n,t,i,l){void 0===l&&(l=null!==n.guild_id),s.dirtyDispatch({type:e.CREATE_PENDING_REPLY,channel:n,message:t,shouldMention:i,showMentionToggle:l})}async deletePendingReply(t){s.dirtyDispatch({type:e.DELETE_PENDING_REPLY,channelId:n(),...t})}channelSelect=e=>{this.activeChannel!==e.channelId&&(this.activeChannel=e.channelId,this.messageIndex=-1)};onCreatePendingReply=e=>{this.replyingToMessage!==e.message.id&&(this.replyingToMessage=e.message.id)};onDeletePendingReply=e=>{this.replyingToMessage=void 0,e[this.QRSymbol]||(this.messageIndex=-1)};keyDown=async e=>{if(!e.ctrlKey)return;if("ArrowUp"!==e.key&&"ArrowDown"!==e.key)return;let s=(await i(n())).toArray().reverse(),t=s.findIndex((e=>e.id===this.replyingToMessage))||0;if("ArrowUp"===e.key?this.messageIndex=t+1:"ArrowDown"===e.key&&(this.messageIndex=t-1),this.messageIndex>s.length&&(this.messageIndex=s.length),this.messageIndex<0)return this.deletePendingReply();let l=s[this.messageIndex];this.deletePendingReply({[this.QRSymbol]:!0}),this.createPendingReply(this.getCurrentChannel(),l,!0)};startPlugin(){s.subscribe(e.CHANNEL_SELECT,this.channelSelect),s.subscribe(e.CREATE_PENDING_REPLY,this.onCreatePendingReply),s.subscribe(e.DELETE_PENDING_REPLY,this.onDeletePendingReply),window.addEventListener("keydown",this.keyDown)}pluginWillUnload(){s.unsubscribe(e.CHANNEL_SELECT,this.channelSelect),s.unsubscribe(e.CREATE_PENDING_REPLY,this.onCreatePendingReply),s.unsubscribe(e.DELETE_PENDING_REPLY,this.onDeletePendingReply),window.removeEventListener("keydown",this.keyDown)}};return{onLoad:l.startPlugin,onUnload:l.pluginWillUnload}})();